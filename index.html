<!DOCTYPE html> 
<!-- The doctype declaration tells the browser the version of HTML that the document is written in. -->
<html lang="en">
<!-- The <html> element is the root element of an HTML page, and indicates that the page is written in HTML. -->
<head>
    <meta charset="UTF-8">
    <!-- The <meta> element provides metadata about the HTML document, such as character encoding. -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- This meta tag tells Internet Explorer to use the latest version of the rendering engine. -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- The viewport meta tag specifies how the website should be scaled on different devices. -->
    <title>O&M Store</title>
    <!-- The title element defines the title of the document, which is displayed in the browser's title bar. -->
</head>
 
<body style="font-size: 20px; background-color: aquamarine;
color: red;">
    <h3 align="center">Store Outward Management</h3>
    <!-- The <h1> element defines a heading. The id attribute creates a unique identifier for the element. -->
    <div align="center">
        <form id="myForm">
            <label for="division">Division:</label>
  <select id="division">
  <option value="Select">Select</option>
    <option value="JKP">JKP</option>
    <option value="PLM">PLM</option>
  </select>
  
  <label for="zone">Zone:</label>
  <select id="zone"></select><br>
        <label for="order_date"><b>Date:</b></label>
    <input type="date" name="date" required><br>
    <br><b>Name:</b>
            <select id="name" name="name" required></select>
           
            <br><br>
        <!-- The <input> element is a form control element that allows the user to input data. -->
        <b>Item:</b>
    <select name="item" id="item" required>
            <option value="LT TAPE">LT TAPE</option>
            <option value="HT TAPE">HT TAPE</option>
         <option value="HT TAPE 70">HT TAPE 70</option>
            <option value="FW 14">FW 14</option>
            <option value="FW 16">FW 16</option>
            <option value="FW 18">FW 18</option>
            <option value="PRC">PRC</option>
            <option value="BLADE">BLADE</option>
            <option value="CRC">CRC</option>
            <option value="DHOTI">DHOTI</option>
            <option value="SOCKET 25
            ">SOCKET 25
        </option>
            <option value="SOCKET 50
            ">SOCKET 50
        </option>
            <option value="SOCKET 95
            ">SOCKET 95
        </option>
            <option value="SOCKET 150
            ">SOCKET 150
        </option>
<option value="SOCKET 300">SOCKET 300</option>
<option value="SOCKET 630">SOCKET 630</option>
<option value="SOCKET LB 95">SOCKET LB 95</option>
<option value="SOCKET LB 150">SOCKET LB 150</option>
<option value="SOCKET LB 300">SOCKET LB 300</option>
<option value="SOCKET LB 630">SOCKET LB 630</option>
  <option value="DT LUGS">DT LUGS</option>          
<option value="AB CABLE">AB CABLE</option>         
<option value="MESSENGER WIRE">MESSENGER WIRE</option>
<option value="CABLE 2*10">CABLE 2*10</option>
<option value="CABLE 2*25">CABLE 2*25</option>
<option value="CABLE 4*25">CABLE 4*25</option>
<option value="CABLE 4*50">CABLE 4*50</option>
<option value="CABLE 3*150">CABLE 3*150</option>
<option value="CABLE 4*150">CABLE 4*150</option>
<option value="CABLE 3*300">CABLE 3*300</option>
<option value="CABLE 4*300">CABLE 4*300</option>
<option value="CABLE 3*400">CABLE 3*400</option>
        <option value="1*300 LEAD">300 LEAD</option>
<option value="1*630 LEAD">630 LEAD</option>
<option value="DT OIL">DT OIL</option>
<option value="SILICA GEL">SILICA GEL</option>
<option value="BREATHER">BREATHER</option>
<option value="NB 2">NB 2</option>
<option value="NB 3">NB 3</option>
<option value="NB 5">NB 5</option>
<option value="NB 7">NB 7</option>
<option value="NB 9">NB 9</option>
         <option value="DISTRIBUTION BOX">DISTRIBUTION BOX</option>
         <option value="LT POLE">LT POLE</option>
         <option value="HT POLE">HT POLE</option>
        <option value="POLE CLAMP">POLE CLAMP</option>
        <option value="SUSPENSION">SUSPENSION</option>
         <option value="TO LINE">TO LINE</option>
         <option value="EYE HOOK">EYE HOOK</option>
        <option value="ANTI TRACKING SPRAY">ANTI TRACKING SPRAY</option>
        <option value="RED PAINT">RED PAINT</option>
        <option value="YELLOW PAINT">YELLOW PAINT</option>
        <option value="BLUE PAINT">BLUE PAINT</option>
        <option value="BLACK PAINT">BLACK PAINT</option>
            </select></br></br>
        <b>Quantity:</b><input type="number" name="quantity" placeholder='Quantity' required><br><br>
            <b>Unit:</b>
            <select name="unit" id="unit" required>
                 <option value="Nos.">Nos.</option>
                 <option value="Metre">M</option>
                 <option value="Gram">Gram</option>
                 <option value="Set">Set</option>
                 <option value="Litre">Litre</option>
            </select>
            <br><br>
    <b>Address:</b><input name="address" placeholder='Address'>
    </br>
    </br>
        <button class="sbtn" type="submit" id="runScriptButton">Submit</button>
    <style>
.sbtn {
  display: inline-block;
  padding: 15px 25px;
  color: #fff;
  background-color: #708090;
  border:none;
  border-radius: 15px;

}
.sbtn:active {
  background-color: #00cc00;
  transform: translateY(6px);
}
</style>
        <br><br><br>
        <h1 id="msg"></h1><br>
        <button onclick="location.reload()">Reload</button>&nbsp;&nbsp;
        <!-- The <input type="submit"> element creates a submit button. The id attribute creates a unique identifier for the element. -->
    </form><button onClick="viewFunc()">View</button>
    </div>
    <script>
  const divisionSelect = document.getElementById('division');
  const zoneSelect = document.getElementById('zone');
  const nameSelect = document.getElementById('name');
  const runScriptButton = document.getElementById('runScriptButton'); // New button element
  
  const options = {
    JKP: {
      B1: ['SUNIL PANDEY', 'SURENDER PAL', 'GAYALAL', 'DINESH', 'RAMSINGH', 'GULLI YADAV', 'SHARWAN', 'BANWARI LAL', 'BHUPENDER', 'DUDNATH', 'RAMCHANDER', 'RAJKUMAR', 'DHRUV', 'RAMBALI', 'HANSRAJ TANWAR', 'PALCHAND', 'HANSRAJ', 'LAXMI NARAYAN', 'RAMULAL', 'SURENDER NISHAD'],
      D4: ['SARWAN', 'RAMU KUMAR RAI', 'LALLAN KUMAR', 'NAVEEN KUMAR', 'NAVEEN KUMAR MANDAL', 'RAJESH', 'RAKESH', 'RAMESH', 'KAILASH RAI', 'RAVENDRA KUMAR MANDAL', 'SANOJ MANDAL', 'VIJENDER', 'ANIL JHA', 'BHAGWAN SINGH', 'KISHOR MAHTO', 'LALIT KUMAR', 'MINTOO MANDAL', 'MUNNA KUMAR', 'RAM JAYAWAN', 'TINKU', 'UGGAN MANDAL', 'VIKASH KUMAR'],
    },
    PLM: {
      Sec_9: ['Ajay Kumar', 'Amit Kumar', 'Ankit Kumar', 'Ashok Kumar', 'Balveer Yadav', 'Banarshi Singh', 'Bhagwan Das', 'Dinesh Kumar', 'Gopal Singh', 'Hukam Singh', 'Jai Parkash', 'Jitendra Singh', 'Jogender Kumar', 'Madan', 'Madan Pal', 'Munish', 'Raju Mishra', 'Rajveer Singh', 'Ram Dass', 'Ramesh Singh Saini', 'Rohit Kumar', 'Sanjeev Kumar', 'Satish Kumar Patel', 'Sudhir Kumar', 'Suraj Patel', 'Magan Singh', 'Suresh Kumar', 'Vinesh Kumar', 'Vipin Kumar', 'Yagya Kumar', 'JITENDER'],
    },
  };
  
  divisionSelect.addEventListener('change', (event) => {
    const selectedDivision = event.target.value;
    const zones = options[selectedDivision];
    
    // Clear previous zone and name options
    zoneSelect.innerHTML = '';
    nameSelect.innerHTML = '';
    
    // Populate zone options
    Object.keys(zones).forEach(zoneKey => {
      const option = document.createElement('option');
      option.value = zoneKey;
      option.textContent = zoneKey;
      zoneSelect.appendChild(option);
    });
    
    // Trigger change event on zoneSelect to populate names
    zoneSelect.dispatchEvent(new Event('change'));
  });
  
  zoneSelect.addEventListener('change', (event) => {
    const selectedDivision = divisionSelect.value;
    const selectedZone = event.target.value;
    const names = options[selectedDivision][selectedZone];
    
    // Clear previous name options
    nameSelect.innerHTML = '';
    
    // Populate name options
    names.forEach(name => {
      const option = document.createElement('option');
      option.value = name;
      option.textContent = name;
      nameSelect.appendChild(option);
    });
  });
  
  // Add event listener to the button
  runScriptButton.addEventListener('click', () => {
    const selectedDivision = divisionSelect.value;
    const selectedZone = zoneSelect.value;
    
    // Perform your desired action based on the selected zone
    if (selectedDivision === 'JKP' && selectedZone === 'B1') {
        let form = document.querySelector("form");
        // The document.querySelector() method returns the first element that matches a specified CSS selector.
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            // The preventDefault() method stops the form from submitting and prevents the page from refreshing.
            document.querySelector("#runScriptButton").value = "Submiting..";
            // Change the value of the submit button to "Submitting..." while the form is being submitted.
            let data = new FormData(form);
            // The FormData() method creates a new FormData object that contains the values of all the form fields.
            fetch('https://script.google.com/macros/s/AKfycbxZB_OcFDg_xmRJOpQSoKoYzs26DUkMu7wA1DC8eLTfw-9Ir2QuuuIGvWdZzr1Lru9e/exec', {
                    method: "POST",
                    body: data
                })
                // The fetch() method is used to make a request to the server and retrieve data.
                // This is an example API endpoint. Replace it with the actual URL for the API endpoint you want to use.
                .then(res => res.text())
                // The .then() method is used to handle the response from the server.
                // The response is converted to text using the res.text() method.
                .then(data => {
                    document.querySelector("#msg").innerHTML = data;
                    // The innerHTML property sets or returns the HTML content of an element.
                    // Here, we are setting the content of the <h1> element to the response from the server.
                    document.querySelector("#runScriptButton").value = "Submit"
                    // Change the value of the submit button back to "Submit" after the form has been submitted.
                });
        })
      // Add your script code here
    } else if (selectedDivision === 'JKP' && selectedZone === 'D4') {
        let form = document.querySelector("form");
        // The document.querySelector() method returns the first element that matches a specified CSS selector.
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            // The preventDefault() method stops the form from submitting and prevents the page from refreshing.
            document.querySelector("#runScriptButton").value = "Submiting..";
            // Change the value of the submit button to "Submitting..." while the form is being submitted.
            let data = new FormData(form);
            // The FormData() method creates a new FormData object that contains the values of all the form fields.
            fetch('https://script.google.com/macros/s/AKfycbz4mlFyMXsaeZ4Z7lu9ksTGzlfBYkBu67g3f7AQGDSYivUTnAE_wFe_91sBDwD5BqOXEQ/exec', {
                    method: "POST",
                    body: data
                })
                // The fetch() method is used to make a request to the server and retrieve data.
                // This is an example API endpoint. Replace it with the actual URL for the API endpoint you want to use.
                .then(res => res.text())
                // The .then() method is used to handle the response from the server.
                // The response is converted to text using the res.text() method.
                .then(data => {
                    document.querySelector("#msg").innerHTML = data;
                    // The innerHTML property sets or returns the HTML content of an element.
                    // Here, we are setting the content of the <h1> element to the response from the server.
                    document.querySelector("#runScriptButton").value = "Submit"
                    // Change the value of the submit button back to "Submit" after the form has been submitted.
                });
        })
      // Add your script code here
    } else if (selectedDivision === 'PLM' && selectedZone === 'Sec_9') {
        let form = document.querySelector("form");
        // The document.querySelector() method returns the first element that matches a specified CSS selector.
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            // The preventDefault() method stops the form from submitting and prevents the page from refreshing.
            document.querySelector("#runScriptButton").value = "Submiting..";
            // Change the value of the submit button to "Submitting..." while the form is being submitted.
            let data = new FormData(form);
            // The FormData() method creates a new FormData object that contains the values of all the form fields.
            fetch('https://script.google.com/macros/s/AKfycbw4m1cylPXO-1qqbljEI_isAzkrIePBYa9s0w2M7oM66jTN4uGGd2CVwGdkBuGMvZnf/exec', {
                    method: "POST",
                    body: data
                })
                // The fetch() method is used to make a request to the server and retrieve data.
                // This is an example API endpoint. Replace it with the actual URL for the API endpoint you want to use.
                .then(res => res.text())
                // The .then() method is used to handle the response from the server.
                // The response is converted to text using the res.text() method.
                .then(data => {
                    document.querySelector("#msg").innerHTML = data;
                    // The innerHTML property sets or returns the HTML content of an element.
                    // Here, we are setting the content of the <h1> element to the response from the server.
                    document.querySelector("#runScriptButton").value = "Submit"
                    // Change the value of the submit button back to "Submit" after the form has been submitted.
                });
        })
      // Add your script code here
    }
    // Add more conditions as needed for other zones
    
    // You can replace the alert with your actual script logic
  });
</script>
    <script>
    function viewFunc() {
        const dropdown = document.getElementById("zone");
        const selectedOptionValue = dropdown.value;
        
        if (selectedOptionValue === "B1") {
            window.location.href = "https://docs.google.com/spreadsheets/d/1mtfOXxjvQP_AFzyW74G3TFyUMiqfaSirfNb8rGBRJ50/edit?usp=drivesdk";
        } 
        else if (selectedOptionValue === "Sec_9") {
            window.location.href = "https://docs.google.com/spreadsheets/d/1lJed6KXcJhS7rHGsTq7spCW23wajsMTSOJh1VwLfUfA/edit?usp=sharing";
        }
        else if (selectedOptionValue === "D4") {
            window.location.href = "https://docs.google.com/spreadsheets/d/1mMXGgkaGWwMuTTateTNMkA9m4oyAD4a1y-wBm0EFKM0/edit?usp=sharing";
        }
    }
</script>
</body>
</html>
